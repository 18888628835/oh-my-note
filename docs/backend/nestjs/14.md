# Nest ä½¿ç”¨ redis

åˆ›å»ºé¡¹ç›®ï¼š

```bash
nest new redis-next-test -p pnpm
```

å®‰è£… [redis](https://github.com/redis/node-redis) åŒ…

```bash
pnpm install redis
```

appModule ä¸­ä½¿ç”¨ useFactory åŠ¨æ€æ³¨å…¥ redis Providerã€‚

```typescript
@Module({
  imports: [],
  controllers: [AppController],
  providers: [
    AppService,
    {
      provide: 'REDIS_Client',
      useFactory: async () => {
        const client = createClient({
          socket: {
            host: 'localhost',
            port: 6379,
          },
        });
        await client.connect();
        return client;
      },
    },
  ],
})
```

æ³¨å…¥åˆ° service å¹¶è·å–æ‰€æœ‰çš„ keys

```typescript
import { Inject, Injectable } from '@nestjs/common'
import { RedisClientType } from 'redis'

@Injectable()
export class AppService {
  constructor(@Inject('REDIS_Client') private readonly redisClient: RedisClientType) {}
  async getHello(): Promise<string> {
    const allKeys = await this.redisClient.keys('*')
    console.log('â€”â€”â€”â€”â€”â€”ğŸš€ğŸš€ğŸš€ğŸš€ğŸš€ â€”â€” allKeys:', allKeys)
    return 'Hello World!'
  }
}
```

![image-20231021203501304](https://raw.githubusercontent.com/18888628835/image-cloud/main/assets202310212035467.png)
